name: opencart
reset_timeout: 60000
environment_ready_timeout: 300000
datasets:
- name: base
  description: Base dataset with admin credentials
  variables:
    username: admin
    password: password
    wrong_password: wrongpassword
  flows:
  - login
  - incorrect_login
flows:
- name: login
  description: Standard login flow for OpenCart
  steps:
  - action: navigate
    description: Navigate to OpenCart admin login page
    url: /administration
  - action: screenshot
    description: Screenshot before login (initial page)
    filename: 01_before_login.png
  - action: wait
    description: Wait for page to fully load
    duration: 5000
  - action: wait_for_selector
    description: Wait for username/email field
    selector: 'input[name="username"], input[name="email"], #input-username, #input-email, input[type="text"]'
    timeout: 15000
  - action: fill
    description: Fill username/email field
    selector: 'input[name="username"], input[name="email"], #input-username, #input-email, input[type="text"]'
    value: $username
  - action: click
    description: Click on username field to ensure form is active
    selector: 'input[name="username"], input[name="email"], #input-username, #input-email, input[type="text"]'
  - action: wait
    description: Wait for password field to appear
    duration: 3000
  - action: screenshot
    description: Screenshot before attempting to find password field
    filename: 01b_before_password.png
  - action: wait_for_selector
    description: Wait for password field with broader selector
    selector: 'input[type="password"], [name="password"], #input-password, .password-field, form input:not([name="username"]):not([name="email"])'
    timeout: 20000
  - action: fill
    description: Fill password field with broader selector
    selector: 'input[type="password"], [name="password"], #input-password, .password-field, form input:not([name="username"]):not([name="email"])'
    value: $password
  - action: wait
    description: Wait for form to fully load
    duration: 1000
  - action: wait
    description: Wait for any dynamic form elements to load
    duration: 2000
  - action: wait_for_selector
    description: Wait for submit button
    selector: button[type="submit"], input[type="submit"], .btn-primary, .btn-login
    timeout: 15000
  - action: screenshot
    description: Screenshot after credentials entered, before submission
    filename: 02_credentials_entered.png
  - action: click
    description: Click login submit button
    selector: button[type="submit"], input[type="submit"], .btn-primary
  - action: wait
    description: Wait for login to process
    duration: 3000
  - action: screenshot
    description: Screenshot after login attempt
    filename: 03_after_login.png
  - action: wait
    description: Wait for login to process
    duration: 5000
  - action: verify_no_errors
    description: Verify no login errors are displayed
    error_selectors:
    - .alert-danger
    - .alert-error
    - .error-message
    - .text-danger
    - .invalid-feedback
    - .login-error
    - .auth-error
    - .error
    - .alert
  - action: verify
    description: Verify successful login by checking for main interface elements
    selector: '.dashboard, .main-content, .navbar, .sidebar, #menu, .breadcrumb, .panel'
    type: element_exists
- name: incorrect_login
  description: Verify login fails with incorrect password
  steps:
  - action: navigate
    description: Navigate to OpenCart admin login page
    url: /administration
  - action: screenshot
    description: Screenshot before incorrect login attempt
    filename: 01_before_incorrect_login.png
  - action: wait
    description: Wait for page to fully load
    duration: 3000
  - action: wait_for_selector
    description: Wait for username/email field
    selector: 'input[name="username"], input[name="email"], #input-username, #input-email, input[type="text"]'
    timeout: 15000
  - action: fill
    description: Fill username/email field with valid username
    selector: 'input[name="username"], input[name="email"], #input-username, #input-email, input[type="text"]'
    value: $username
  - action: wait_for_selector
    description: Wait for password field
    selector: 'input[type="password"], [name="password"], #input-password, .password-field, form input:not([name="username"]):not([name="email"])'
    timeout: 5000
  - action: fill
    description: Fill password field with incorrect password
    selector: 'input[type="password"], [name="password"], #input-password, .password-field, form input:not([name="username"]):not([name="email"])'
    value: $wrong_password
  - action: screenshot
    description: Screenshot after entering incorrect credentials
    filename: 02_incorrect_credentials_entered.png
  - action: click
    description: Click login submit button
    selector: button[type="submit"], input[type="submit"], .btn-primary
  - action: wait
    description: Wait for login attempt to process
    duration: 3000
  - action: screenshot
    description: Screenshot after incorrect login attempt
    filename: 03_after_incorrect_login.png
  - action: wait
    description: Wait for error message to appear
    duration: 2000
  - action: verify
    description: Verify error message is displayed
    selector: '.alert-danger, .alert.alert-danger, div.alert-dismissible.alert-danger, .alert, [class*="alert"], [class*="error"], [class*="danger"], .text-danger, .warning, #alert, .message, .notification, div[role="alert"], .has-error, .panel-danger'
    type: element_exists
