flows:
- name: login
  description: Complete login flow for Paperless-ngx with verification
  steps:
  - description: Wait for page to fully load
    duration: 3000
    type: wait
  - description: Wait for username field
    selector: 'input[name="username"], input[name="login"], #id_username'
    timeout: 15000
    type: wait_for_selector
  - description: Fill username field
    selector: 'input[name="username"], input[name="login"], #id_username'
    type: fill
    value: admin
  - description: Wait for password field
    selector: 'input[name="password"], #id_password, input[type="password"]'
    timeout: 10000
    type: wait_for_selector
  - description: Fill password field
    selector: 'input[name="password"], #id_password, input[type="password"]'
    type: fill
    value: password
  - description: Wait for login button
    selector: button[type="submit"], input[type="submit"], .btn-primary
    timeout: 10000
    type: wait_for_selector
  - description: Click login button
    selector: button[type="submit"], input[type="submit"], .btn-primary
    type: click
  - description: Wait for login to process and redirect
    duration: 5000
    type: wait
  - description: Verify no login errors displayed
    error_selectors:
    - .alert-danger
    - .alert-error
    - .error
    - .invalid-feedback
    - .errorlist
    type: verify_no_errors
  - contains: true
    description: Verify redirected to dashboard/home
    type: verify_url
    url: /
  - description: Verify main navigation present
    selector: .navbar, .sidebar, nav
    type: verify
    verify_type: element_exists
  - description: Verify dashboard navigation active
    selector: .nav-link.active, [routerlink="dashboard"]
    type: verify
    verify_type: element_exists
  - description: Verify authenticated user dropdown present
    selector: '#userDropdown, .dropdown-toggle'
    type: verify
    verify_type: element_exists
  - contains: true
    description: Verify page title indicates Paperless
    title: Paperless
    type: verify
    verify_type: page_title
- name: incorrect_login
  description: Verify login fails with incorrect password
  steps:
  - description: Wait for page to fully load after navigation
    duration: 5000
    type: wait
  - description: Wait for username field
    selector: 'input[name="login"], #inputUsername, input[type="text"]'
    timeout: 15000
    type: wait_for_selector
  - description: Fill username field
    selector: 'input[name="login"], #inputUsername, input[type="text"]'
    type: fill
    value: admin
  - description: Wait for password field
    selector: 'input[name="password"], #inputPassword, input[type="password"]'
    timeout: 5000
    type: wait_for_selector
  - description: Fill password field with incorrect password
    selector: 'input[name="password"], #inputPassword, input[type="password"]'
    type: fill
    value: wrongpassword
  - description: Click login button
    selector: button[type="submit"], input[type="submit"], .btn-primary
    type: click
  - description: Wait for login attempt to process
    duration: 3000
    type: wait
  - contains: true
    description: Verify still on login route after incorrect login
    type: verify_url
    url: /accounts/login
  - contains: true
    description: Verify page shows Forbidden title
    title: Forbidden
    type: verify
    verify_type: page_title
  - description: Verify CSRF error is displayed
    selector: h1:has-text("Forbidden"), body:has-text("CSRF verification failed")
    type: verify
    verify_type: element_exists
