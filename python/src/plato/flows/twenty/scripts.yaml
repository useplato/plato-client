flows:
- name: login
  description: Complete login flow for Twenty CRM (Plato UI)
  steps:
  - description: Navigate to Twenty CRM home page
    type: navigate
    url: /
  - description: Screenshot before login (initial screen)
    filename: 01_before_login.png
    type: screenshot
  - description: Wait for login modal to appear
    duration: 5000
    type: wait
  - description: Wait for Continue with Email button
    selector: button:has-text("Continue with Email")
    timeout: 15000
    type: wait_for_selector
  - description: Click "Continue with Email" button on Plato modal
    selector: button:has-text("Continue with Email")
    type: click
  - description: Wait for email input to appear
    duration: 2000
    type: wait
  - description: Screenshot after Continue screen
    filename: 02_after_email.png
    type: screenshot
  - description: Wait for email input field
    selector: input[placeholder='Email']
    timeout: 10000
    type: wait_for_selector
  - description: Fill in email
    selector: input[placeholder='Email']
    type: fill
    value: plato@gmail.com
  - description: Wait for continue/submit button
    selector: button:has-text('Continue'), button[type='submit']
    timeout: 10000
    type: wait_for_selector
  - description: Submit email to proceed
    selector: button:has-text('Continue'), button[type='submit']
    type: click
  - description: Wait for password screen
    duration: 2000
    type: wait
  - description: Wait for password input field
    selector: input[type='password'], input[name='password']
    timeout: 5000
    type: wait_for_selector
  - description: Fill in password
    selector: input[type='password'], input[name='password']
    type: fill
    value: password
  - description: Screenshot after entering email and password
    filename: 02_credentials_entered.png
    type: screenshot
  - description: Wait for login button
    selector: button:has-text('Log in'), button[type='submit']
    timeout: 10000
    type: wait_for_selector
  - description: Click login button
    selector: button:has-text('Log in'), button[type='submit']
    type: click
  - description: Wait for login to process
    duration: 5000
    type: wait
  - description: Screenshot after login
    filename: 03_after_login.png
    type: screenshot
  - description: Final wait for dashboard or redirect
    duration: 5000
    type: wait
  - description: Verify no errors visible after login
    error_selectors:
    - .alert-danger
    - .alert-error
    - .error-message
    - .invalid-feedback
    - .login-error
    - .auth-error
    - .error
    - .alert
    type: verify_no_errors
  - contains: true
    description: Verify redirected to book call decision (post-login)
    type: verify_url
    url: /book
  - description: Verify workspace dropdown present (authenticated UI)
    selector: '[data-testid="workspace-dropdown"]'
    type: verify
    verify_type: element_exists
  - description: Verify navigation/sidebar present
    selector: nav, [role="navigation"], aside, [class*="sidebar"], [data-testid*="sidebar"]
    type: verify
    verify_type: element_exists
  - contains: true
    description: Verify page title indicates Twenty
    title: Twenty
    type: verify
    verify_type: page_title
  - description: Wait for Finish button to appear
    selector: button:has-text("Finish"), [aria-label*="Finish"], [data-testid*="finish"]
    timeout: 10000
    type: wait_for_selector
  - description: Click Finish to avoid onboarding booking
    selector: button:has-text("Finish"), [aria-label*="Finish"], [data-testid*="finish"]
    type: click
  - description: Wait for post-finish navigation to settle
    duration: 2000
    type: wait
  - description: Final proof after login
    filename: 99_final.png
    type: screenshot
- name: incorrect_login
  description: Verify login fails with incorrect password
  steps:
  - description: Screenshot before incorrect login attempt
    filename: 01_before_incorrect_login.png
    type: screenshot
  - description: Wait for login modal to appear
    duration: 5000
    type: wait
  - description: Wait for Continue with Email button
    selector: button:has-text("Continue with Email")
    timeout: 15000
    type: wait_for_selector
  - description: Click "Continue with Email" button
    selector: button:has-text("Continue with Email")
    type: click
  - description: Wait for email input to appear
    duration: 2000
    type: wait
  - description: Wait for email input field
    selector: input[placeholder='Email']
    timeout: 10000
    type: wait_for_selector
  - description: Fill in email
    selector: input[placeholder='Email']
    type: fill
    value: plato@gmail.com
  - description: Wait for continue/submit button
    selector: button:has-text('Continue'), button[type='submit']
    timeout: 10000
    type: wait_for_selector
  - description: Submit email to proceed
    selector: button:has-text('Continue'), button[type='submit']
    type: click
  - description: Wait for password screen
    duration: 2000
    type: wait
  - description: Wait for password input field
    selector: input[type='password'], input[name='password']
    timeout: 5000
    type: wait_for_selector
  - description: Fill in incorrect password
    selector: input[type='password'], input[name='password']
    type: fill
    value: wrongpassword
  - description: Screenshot after entering incorrect credentials
    filename: 02_incorrect_credentials_entered.png
    type: screenshot
  - description: Wait for login button
    selector: button:has-text("Log in"), button[type="submit"]
    timeout: 10000
    type: wait_for_selector
  - description: Click login button
    selector: button:has-text("Log in"), button[type="submit"]
    type: click
  - description: Wait for login attempt to process
    duration: 3000
    type: wait
  - description: Screenshot after incorrect login attempt
    filename: 03_after_incorrect_login.png
    type: screenshot
  - description: Verify error message is displayed
    selector: '[data-testid="error-message"], .MuiAlert-root, .MuiAlert-standardError,
      .error-message, [data-testid*="error"], .form-error, .text-danger, [class*="error"],
      [role="alert"], [class*="alert"], [class*="danger"], .warning, .fail, .invalid'
    type: verify
    verify_type: element_exists
